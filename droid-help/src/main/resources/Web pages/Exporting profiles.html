<!--

    Copyright (c) 2016, The National Archives <pronom@nationalarchives.gov.uk>
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following
    conditions are met:

     * Redistributions of source code must retain the above copyright
       notice, this list of conditions and the following disclaimer.

     * Redistributions in binary form must reproduce the above copyright
       notice, this list of conditions and the following disclaimer in the
       documentation and/or other materials provided with the distribution.

     * Neither the name of the The National Archives nor the
       names of its contributors may be used to endorse or promote products
       derived from this software without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
    AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
    IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
    PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR
    CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
    EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
    PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
    PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
    LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
    NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
    SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

-->
<html>
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
    <meta content="Helen" name="generator">
    <title>Exporting profiles</title>
  </head>
  <body>
    <table cellpadding="0" bgcolor="#555555" border="0" cellspacing="0" width="100%">
      <tr>
        <td width="399">
          <img src="../Images/droidlogo.gif"> 
        </td>
        <td bgcolor="#555555" width="100%">
          <h5 align="center">
             <img src="../Images/Export.png">&nbsp;&nbsp;&nbsp;<b><font color="#ffffff" size="5"
            face="SansSerif, Verdana, Arial, Helvetica">Exporting profiles</font></b>
          </h5>
        </td>
      </tr>
    </table>
    <table cellpadding="8" bgcolor="#eeeeee" border="0" cellspacing="0" width="100%">
      <tr>
        <td width="25%">
          <a href="Welcome to DROID.html">Welcome to DROID</a> 
        </td>
        <td align="center" width="25%">
          &nbsp;&nbsp;<img src="../Images/Open file small.png">&nbsp;<a href=
          "Load and save profiles.html">Load and save profiles</a> 
        </td>
        <td align="center" width="25%">
          <img src="../Images/Filter small.png"><a href="Explore the results.html">Filter your
          results</a> 
        </td>
        <td align="right" width="25%">
          <img src="../Images/3d bar chart small.png"> &nbsp;<a href=
          "Summary reporting.html">Summary reporting</a> 
        </td>
      </tr>
    </table>
    <p>
       DROID can export all open profiles (which are not currently running) to a CSV file. &nbsp;To
      export a profile, press the <img src="../Images/Export small.png"> <b><font style=
      " background-color: #c0c0c0;" size="4">&nbsp;&nbsp;&nbsp;Export
      &nbsp;</font></b>&nbsp;button, or select the<b><font size="4"> File / Export
      all...</font></b> menu item. This shows the export dialog. The profiles you have open are listed
      in the export window. &nbsp;If a profile is empty, or in the process of running, it is greyed out.
      &nbsp;Select all the profiles you want to  export into a single CSV file by checking the boxes next to
      them. &nbsp;&nbsp;If any of your profiles have active <a href="Explore the results.html">filters</a>, then
      the results will also be filtered. &nbsp;Each profile can have different filters defined and enabled.
    </p>
    <p>
      There are two possible ways of exporting the profiles.
      <ul>
        <li>
          <a href="#SelectColumns">Selecting the columns for export</a>
        </li>
        <li>
          <a href="#SelectExportTemplate">Selecting a predefined Export Template for export</a>
        </li>
      </ul>
    </p>
    <p>
    <h2>
      <a id="SelectColumns" name="SelectColumns">Selecting the columns for export</a>
    </h2>
    </p>
    <p>
      When the "Use export template" checkbox is unchecked, you are presented with an option to select
      one or more columns that you wish to export, as shown below:
    </p>
    <p align="center">
      <img src="../Images/Export dialog.png">
    </p>
    <h2>
      <a id="CSVColumns" name="CSVColumns">CSV File Columns</a>
    </h2>

    <p>
      The following table describes the columns which can be exported from DROID.
    <p>
    <table style="border:1px solid #000" cellpadding="10">
      <tr>
        <th style="border:1px solid #000" bgcolor="#000000"><font color="#ffffff"/>Column Name</th>
        <th style="border:1px solid #000" bgcolor="#000000"><font color="#ffffff"/>Description</th>
        <th style="border:1px solid #000" bgcolor="#000000"><font color="#ffffff"/>Notes</th>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>ID</td>
        <td>This is a unique number assigned to each file, folder or archival file processed by DROID.</td>
        <td></td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>PARENT_ID</td>
        <td>This is the id of the archival file or folder in which this file is contained.</td>
        <td></td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>URI</td>
        <td>Uniform Resource Identifier: This provides a standard, cross-platform way of describing where resources are located.
          &nbsp;URIs are described in more detail in "<a href="Information collected by DROID.html#Location">Information collected by DROID</a></td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>FILE_PATH</td>
        <td>The file system&nbsp;location of the resource being profiled, if the resource was directly
          in a file system. &nbsp;Some files are not on the file system - for example, files inside a
          zip file. In this case, the file paths are written relative to the parent file which
          exists on the file system. Such paths also include the type of archive as a prefix.</td>
        <td>file paths are platform dependent (they are different on Windows and unix).
          &nbsp;DROID will write out file paths for the system on which it is currently running.
          &nbsp;This means that if you profile files on a unix machine, then export the profiles on a
          Windows machine, the file paths will be written out as if they were Windows file paths, and
          vice versa.
        </td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>NAME</td>
        <td>The file name of the resource being profiled.</td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>METHOD</td>
        <td>This field gives the method by which a resource identification has been made.</td>
        <td >
          Possible values:
          <ul>
            <li>
              <b>Extension</b> - the file format was identified only by its filename <a href=
                                                                                                "#Extension">extension</a>. &nbsp;This method may not be very reliable, as the filename
              extension may be wrong. &nbsp;It is only used when DROID cannot identify a resource by
              another method, and cannot usually identify what the version of a file format is, only its
              broad type.
            </li>
            <li>
              <b>Signature</b> - the file format was identified by finding a file format signature inside
              the file itself. &nbsp;This method is more reliable than filename extensions, and can
              identify the precise version of a file format.
            </li>
            <li>
              <b>Container</b> - the file format was identified by finding embedded files and patterns
              within them. &nbsp;This method is as reliable as signature identifications, and can be more
              reliable.
            </li>
          </ul>
        </td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>STATUS</td>
        <td>This field gives the identification status of a resource.</td>
        <td>
          Possible values:
          <ul>
            <li>
              <b>Not done</b> - the resource has not yet been profiled.
            </li>
            <li>
              <b>Done</b> - the resource was processed with no errors.
            </li>
            <li>
              <b>Access denied</b> - the operating system refused to give DROID read permissions to the
              resource.
            </li>
            <li>
              <b>Not found</b> - the resource was moved or deleted before DROID could read it.
            </li>
            <li>
              <b>Error</b> - an error occurred while trying to profile a resource. &nbsp;For example, if
              DROID is prevented from reading a file due to the user not having read permissions to it,
              this will result in a profiling error for that file.
            </li>
          </ul>
        </td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>SIZE</td>
        <td>The size in bytes of a file.</td>
        <td>Only files have a size, folders do not have a size. However, some files can contain other files inside them, for example zip files. In this case, the zip file has a size (as it is a file), and so do the files inside it. The size reported in all cases is the uncompressed size of each file, as it would appear if extracted from the container file.</td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>TYPE</td>
        <td>The type of the resource</td>
        <td>    <p>
          DROID categorises the files and folders it profiles as being one of three types:
        </p>
          <ul>
            <li>
              <img src="../Images/fileResourceType.gif">
              &nbsp;File&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </li>
            <li>
              <img src="../Images/folderResourceType.gif">
              &nbsp;Folder&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </li>
            <li>
              <img src="../Images/containerResourceType.gif"> &nbsp;Archival file&nbsp;(e.g. zip)
            </li>
          </ul>
        </td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>EXT</td>
        <td>The file extension of the resource</td>
        <td>Extension is the last part of a filename following a full stop. Only files have extensions, as they indicate the type of the file. Even if a folder has a full stop in its name, it will not be assigned an extension.</td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>LAST_MODIFIED</td>
        <td>The date and time on which a resource was last modified.</td>
        <td></td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>EXTENSION_MISMATCH</td>
        <td>Whether there is a mismatch between the extension of the resource and its identification by signature</td>
        <td>
          Possible values:
          <ul>
            <li>
              <b>true</b> - the extension of the file is different from the expected extension as identified by DROID.
            </li>
            <li>
              <b>false</b> - the extension of the file matches the expected extension as identified by DROID.
            </li>
          </ul>
        </td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>HASH</td>
        <td>Hash is a fixed-size string of characters that is generated by running the contents of a file through a mathematical algorithm. DROID supports MD%, SHA1, SHA256 and SHA512 algorithms</td>
        <td>
          If you have enabled <a href="Change preferences.html#GenerateHash">hash generation</a> in
          the preferences, then this column will contain the MD5, SHA1, SHA256 or SHA512 hash for each file and archival file
          processed. &nbsp;See "<a href="Detecting duplicate files.html">Detecting duplicate files</a>"
          for more information on hashes.
        </td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>FORMAT_COUNT</td>
        <td>The number of identifications made to the resource.</td>
        <td></td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>PUID</td>
        <td>The PRONOM Unique Identifier of the resource, which identifies the format</td>
        <td>
          The&nbsp;PRONOM Unique IDentifier (PUID) identifies the precise file format of a profiled
          file. When a resource has been identified, it is assigned a PUID. &nbsp;&nbsp;A unique
          identifier exists for every file format that DROID can recognise, and these identifiers are
          maintained in the <a href="http://www.nationalarchives.gov.uk/pronom">PRONOM</a><img src="../Images/Icon_External_Link.png">&nbsp;technical registry database, hosted at the UK National Archives.
        </td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>MIME_TYPE</td>
        <td>The mime type of the resource where known.</td>
        <td>
          The mime-type of an identified file format is a high level format identifier assigned by the
          <a href="http://www.iana.org/assignments/media-types/">Internet Assigned Numbers</a><img src="../Images/Icon_External_Link.png">. &nbsp;It is widely used in email and other internet protocols to identify the type of resource. &nbsp;Not all file formats identified by DROID
          have an assigned mime-type, and different <a href="#PUID">PUIDs</a> assigned by DROID can have the same mime-type
        </td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>FORMAT_NAME</td>
        <td>
          The name of an identified&nbsp;file format, as listed in the <a href="http://www.nationalarchives.gov.uk/pronom">PRONOM</a>
          <img src="../Images/Icon_External_Link.png">&nbsp;technical registry against its
          <a href="#PUID">PUID</a>.
        </td>
      </tr>
      <tr style="border-bottom: 1px solid #000">
        <td>FORMAT_VERSION</td>
        <td>
          The version of an identified file format, as listed in the <a href="http://www.nationalarchives.gov.uk/pronom">PRONOM</a>
          <img src="../Images/Icon_External_Link.png">&nbsp;technical registry against its <a href="#PUID">PUID</a>.
          Not all file formats have a defined version, so this field can be blank even when a file has a PUID.
        </td>
      </tr>
    </table>
    </p>

    <p>
    <h2>
      <a id="#SelectExportTemplate" name="SelectExportTemplate">Selecting a predefined Export Template for export</a>
    </h2>
    </p>
    <p>
      If you have configured any export templates for use with DROID,  the "Use export template" checkbox
      is enabled. Checking this checkbox shows you a view to select one of the configured templates
      to be used for export as shown below:
    </p>
    <p align="center">
      <img src="../Images/Export dialog template.png">
    </p>
    <p>
      An export template is a simple text file, with a .template extension, which defines customisations of
      columns to be exported. Using a template, you can customise headers for the data columns, add new columns
      to the export, convert the data in a column to be uppercase / lowercase and change the order in which columns
      appear in the export. You can make an export template available to Droid by copying it into the
      ".droid6\export_templates" folder. You can customise the columns listed in the <a href="#CSVColumns">CSV Columns</a> section.
    </p>
    <p>
      An example template is shown below:
      <pre>
        <code>version 1.0</code>
        <code>Identifier: $ID</code>
        <code>LowerName: LCASE($NAME)</code>
        <code>Language: "Simplified English"</code>
        <code>Submitter:</code>
      </pre>
    </p>
    <p>
      The above template indicates:
    <ol>
      <li> The template is defined in version 1.0 of template syntax </li>
      <li> There are 4 columns to be exported in the order Identifier, LowerName, Language and Submitter</li>
      <li> Values in the column "Identifier" are populated using values in the "ID" column</li>
      <li> Values in the columns "LowerName" are populated by converting the values from the "NAME" column to lowercase</li>
      <li> There is a non-profile column called "Language" and the values are hardcoded to "Simplified English"</li>
      <li> There is a non-profile column called "Submitter" and the values are left empty </li>
    </ol>
    </p>

    <p>
      Following table describes the operations currently supported by DROID for data modifications.
      These operations can be applied to data columns listed in the <a href="#CSVColumns">CSV Columns</a> table.
    <p>
    <table style="border:1px solid #000" cellpadding="10">
      <tr>
        <th style="border:1px solid #000" bgcolor="#000000"><font color="#ffffff"/>Operation</th>
        <th style="border:1px solid #000" bgcolor="#000000"><font color="#ffffff"/>Description</th>
      </tr>
      <tr><td>LCASE</td><td>Converts the data from specified column to lower case e.g. LCASE($TYPE)</td></tr>
      <tr><td>UCASE</td><td>Converts the data from specified column to upper case e.g. UCASE($FORMAT_NAME)</td></tr>
    </table>
    </p>
    <p>
    <h2>
        Other options
    </h2>
    </p>
    <p>
      Once you have selected the columns to export or selected a template that you wish to use,
      you can also select other options such as whether the values should be enclosed in quotes
      when exporting. You can also select whether the export should produce one row per file,
      or one row per format. &nbsp;When exporting one row per file, each row in the CSV file will
      represent a single file, folder or archival file profiled with DROID. &nbsp;If exporting one
      row per format, each row in the CSV file will be a single format identificaiton made by
      DROID.&nbsp;Since a file can be identified as being more than one possible format, this option
      will produce CSV files with multiple rows for the same file (but with different identifications
      for it).
    </p>
    <p>
      The characters of the export will be encoded as UTF-8 by default. If you need to set this
      to the encoding used on your local machine instead, select 'Platform specific' instead.
    </p>
    <p>
      When you are happy you want to export your profiles, press the <b><font style=
                                                                                      " background-color: #c0c0c0;" size="4">&nbsp;&nbsp;&nbsp;Export
      profiles...&nbsp;</font></b>&nbsp; button. &nbsp;This will bring up a standard file-save
      dialog, in which&nbsp;you can specify where you want your CSV file to be saved. &nbsp;
    </p>
    <table cellpadding="8" bgcolor="#eeeeee" border="0" cellspacing="0" width="100%">
      <tr>
        <td width="25%">
          <a href="Welcome to DROID.html">Welcome to DROID</a> 
        </td>
        <td align="center" width="25%">
          &nbsp;&nbsp;<img src="../Images/Open file small.png">&nbsp;<a href=
          "Load and save profiles.html">Load and save profiles</a> 
        </td>
        <td align="center" width="25%">
          <img src="../Images/Filter small.png"><a href="Explore the results.html">Filter your
          results</a> 
        </td>
        <td align="right" width="25%">
          <img src="../Images/3d bar chart small.png"> &nbsp;<a href=
          "Summary reporting.html">Summary reporting</a> 
        </td>
      </tr>
    </table>
    <h6>
       &nbsp;&nbsp;&nbsp;
    </h6>
  </body>
</html>
